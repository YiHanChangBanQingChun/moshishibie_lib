RGB 影像已保存至 D:\Users\admin\Documents\MATLAB\moshishibie_lib\第四次作业-高光谱降维与分类\outputs\run_20241215_155605\RGB_Pavia_影像.png
总体训练样本的数量为:
900
Function 'perform_pca' executed in 0.0342 seconds.
PCA 累计解释方差曲线已保存至 D:\Users\admin\Documents\MATLAB\moshishibie_lib\第四次作业-高光谱降维与分类\outputs\run_20241215_155605\PCA_累计解释方差曲线.png
选择前 38 个主成分可达到 99.99% 的累计解释方差。
Function 'perform_pca' executed in 0.0473 seconds.

=== 运行分类方法：优化KNN ===
Function 'perform_knn_classification' executed in 8.4146 seconds.
每一类的分类正确率为：
第 1 类正确率为： 74.18%
第 2 类正确率为： 73.38%
第 3 类正确率为： 70.34%
第 4 类正确率为： 93.18%
第 5 类正确率为： 99.28%
第 6 类正确率为： 72.53%
第 7 类正确率为： 90.08%
第 8 类正确率为： 72.61%
第 9 类正确率为： 100.00%
总体分类正确率为: 76.40%

=== 运行分类方法：随机森林 ===
Training Random Forest with 100 trees...
Classifying test data with Random Forest...
Function 'perform_random_forest_classification' executed in 0.7856 seconds.
每一类的分类正确率为：
第 1 类正确率为： 78.52%
第 2 类正确率为： 84.96%
第 3 类正确率为： 75.24%
第 4 类正确率为： 95.61%
第 5 类正确率为： 99.52%
第 6 类正确率为： 79.75%
第 7 类正确率为： 91.95%
第 8 类正确率为： 78.62%
第 9 类正确率为： 99.88%
总体分类正确率为: 84.03%

=== 运行分类方法：SVM ===
Training SVM classifiers with kernel='poly'...
Classifying test data with SVM classifiers...
Function 'perform_svm_classification' executed in 6.5592 seconds.
每一类的分类正确率为：
第 1 类正确率为： 65.17%
第 2 类正确率为： 53.45%
第 3 类正确率为： 47.27%
第 4 类正确率为： 97.84%
第 5 类正确率为： 99.52%
第 6 类正确率为： 50.74%
第 7 类正确率为： 91.38%
第 8 类正确率为： 42.18%
第 9 类正确率为： 100.00%
总体分类正确率为: 60.27%

=== 运行分类方法：深度学习 ===
Epoch 1/100

 1/23 [>.............................] - ETA: 43s - loss: 3.0237 - accuracy: 0.1562
 8/23 [=========>....................] - ETA: 0s - loss: 3.2114 - accuracy: 0.1484 
16/23 [===================>..........] - ETA: 0s - loss: 3.0005 - accuracy: 0.1855
23/23 [==============================] - 2s 20ms/step - loss: 2.8872 - accuracy: 0.1972 - val_loss: 2.4667 - val_accuracy: 0.1556 - lr: 0.0010
Epoch 2/100

 1/23 [>.............................] - ETA: 0s - loss: 2.6332 - accuracy: 0.2812
 7/23 [========>.....................] - ETA: 0s - loss: 2.2617 - accuracy: 0.3705
13/23 [===============>..............] - ETA: 0s - loss: 2.0997 - accuracy: 0.3894
22/23 [===========================>..] - ETA: 0s - loss: 2.0005 - accuracy: 0.4219
23/23 [==============================] - 0s 11ms/step - loss: 1.9973 - accuracy: 0.4236 - val_loss: 2.4091 - val_accuracy: 0.2056 - lr: 0.0010
Epoch 3/100

 1/23 [>.............................] - ETA: 0s - loss: 1.6638 - accuracy: 0.4688
10/23 [============>.................] - ETA: 0s - loss: 1.6401 - accuracy: 0.5813
19/23 [=======================>......] - ETA: 0s - loss: 1.6059 - accuracy: 0.5822
23/23 [==============================] - 0s 9ms/step - loss: 1.6247 - accuracy: 0.5778 - val_loss: 2.3394 - val_accuracy: 0.2667 - lr: 0.0010
Epoch 4/100

 1/23 [>.............................] - ETA: 0s - loss: 1.4719 - accuracy: 0.6250
 7/23 [========>.....................] - ETA: 0s - loss: 1.3374 - accuracy: 0.6830
14/23 [=================>............] - ETA: 0s - loss: 1.3882 - accuracy: 0.6696
22/23 [===========================>..] - ETA: 0s - loss: 1.4359 - accuracy: 0.6321
23/23 [==============================] - 0s 11ms/step - loss: 1.4333 - accuracy: 0.6347 - val_loss: 2.2738 - val_accuracy: 0.3000 - lr: 0.0010
Epoch 5/100

 1/23 [>.............................] - ETA: 0s - loss: 1.2774 - accuracy: 0.6562
11/23 [=============>................] - ETA: 0s - loss: 1.2714 - accuracy: 0.6989
20/23 [=========================>....] - ETA: 0s - loss: 1.3098 - accuracy: 0.6719
23/23 [==============================] - 0s 10ms/step - loss: 1.2831 - accuracy: 0.6833 - val_loss: 2.2259 - val_accuracy: 0.3222 - lr: 0.0010
Epoch 6/100

 1/23 [>.............................] - ETA: 0s - loss: 1.1991 - accuracy: 0.7188
10/23 [============>.................] - ETA: 0s - loss: 1.0906 - accuracy: 0.7688
21/23 [==========================>...] - ETA: 0s - loss: 1.0771 - accuracy: 0.7604
23/23 [==============================] - 0s 9ms/step - loss: 1.0842 - accuracy: 0.7583 - val_loss: 2.1768 - val_accuracy: 0.3222 - lr: 0.0010
Epoch 7/100

 1/23 [>.............................] - ETA: 0s - loss: 1.1083 - accuracy: 0.7500
10/23 [============>.................] - ETA: 0s - loss: 0.9985 - accuracy: 0.7531
18/23 [======================>.......] - ETA: 0s - loss: 1.0104 - accuracy: 0.7448
23/23 [==============================] - 0s 10ms/step - loss: 1.0022 - accuracy: 0.7542 - val_loss: 2.1123 - val_accuracy: 0.3389 - lr: 0.0010
Epoch 8/100

 1/23 [>.............................] - ETA: 0s - loss: 0.9397 - accuracy: 0.7188
 7/23 [========>.....................] - ETA: 0s - loss: 0.9576 - accuracy: 0.7679
14/23 [=================>............] - ETA: 0s - loss: 0.9962 - accuracy: 0.7612
21/23 [==========================>...] - ETA: 0s - loss: 0.9734 - accuracy: 0.7708
23/23 [==============================] - 0s 10ms/step - loss: 0.9876 - accuracy: 0.7639 - val_loss: 2.1264 - val_accuracy: 0.3444 - lr: 0.0010
Epoch 9/100

 1/23 [>.............................] - ETA: 0s - loss: 0.7952 - accuracy: 0.8438
 8/23 [=========>....................] - ETA: 0s - loss: 0.8169 - accuracy: 0.8438
16/23 [===================>..........] - ETA: 0s - loss: 0.8346 - accuracy: 0.8320
23/23 [==============================] - 0s 8ms/step - loss: 0.8628 - accuracy: 0.8236 - val_loss: 2.1283 - val_accuracy: 0.3611 - lr: 0.0010
Epoch 10/100

 1/23 [>.............................] - ETA: 0s - loss: 0.7993 - accuracy: 0.7812
 9/23 [==========>...................] - ETA: 0s - loss: 0.8412 - accuracy: 0.8090
19/23 [=======================>......] - ETA: 0s - loss: 0.8214 - accuracy: 0.8240
23/23 [==============================] - 0s 8ms/step - loss: 0.8223 - accuracy: 0.8167 - val_loss: 2.1366 - val_accuracy: 0.4000 - lr: 0.0010
Epoch 11/100

 1/23 [>.............................] - ETA: 0s - loss: 0.7111 - accuracy: 0.8125
 9/23 [==========>...................] - ETA: 0s - loss: 0.7462 - accuracy: 0.8542
19/23 [=======================>......] - ETA: 0s - loss: 0.7631 - accuracy: 0.8487
23/23 [==============================] - 0s 7ms/step - loss: 0.7484 - accuracy: 0.8528 - val_loss: 2.1596 - val_accuracy: 0.3944 - lr: 0.0010
Epoch 12/100

 1/23 [>.............................] - ETA: 0s - loss: 0.6901 - accuracy: 0.8438
 9/23 [==========>...................] - ETA: 0s - loss: 0.8215 - accuracy: 0.8194
16/23 [===================>..........] - ETA: 0s - loss: 0.8090 - accuracy: 0.8262
23/23 [==============================] - 0s 9ms/step - loss: 0.7914 - accuracy: 0.8403 - val_loss: 2.2382 - val_accuracy: 0.4000 - lr: 0.0010
Epoch 13/100

 1/23 [>.............................] - ETA: 0s - loss: 0.9531 - accuracy: 0.8125
 4/23 [====>.........................] - ETA: 0s - loss: 0.7717 - accuracy: 0.8672
12/23 [==============>...............] - ETA: 0s - loss: 0.7703 - accuracy: 0.8594
21/23 [==========================>...] - ETA: 0s - loss: 0.7475 - accuracy: 0.8676
23/23 [==============================] - 0s 9ms/step - loss: 0.7485 - accuracy: 0.8653 - val_loss: 2.2881 - val_accuracy: 0.4000 - lr: 2.0000e-04
Epoch 14/100

 1/23 [>.............................] - ETA: 0s - loss: 0.6889 - accuracy: 0.8750
 8/23 [=========>....................] - ETA: 0s - loss: 0.7256 - accuracy: 0.8750
17/23 [=====================>........] - ETA: 0s - loss: 0.7253 - accuracy: 0.8658
23/23 [==============================] - 0s 8ms/step - loss: 0.7132 - accuracy: 0.8694 - val_loss: 2.3215 - val_accuracy: 0.4056 - lr: 2.0000e-04
Epoch 15/100

 1/23 [>.............................] - ETA: 0s - loss: 0.9507 - accuracy: 0.7500
10/23 [============>.................] - ETA: 0s - loss: 0.7367 - accuracy: 0.8406
20/23 [=========================>....] - ETA: 0s - loss: 0.7315 - accuracy: 0.8594
23/23 [==============================] - 0s 8ms/step - loss: 0.7302 - accuracy: 0.8639 - val_loss: 2.3403 - val_accuracy: 0.4056 - lr: 2.0000e-04
Epoch 16/100

 1/23 [>.............................] - ETA: 0s - loss: 0.7677 - accuracy: 0.8125
10/23 [============>.................] - ETA: 0s - loss: 0.7084 - accuracy: 0.8656
20/23 [=========================>....] - ETA: 0s - loss: 0.6952 - accuracy: 0.8781
23/23 [==============================] - 0s 8ms/step - loss: 0.6875 - accuracy: 0.8792 - val_loss: 2.3612 - val_accuracy: 0.4056 - lr: 2.0000e-04
Epoch 17/100

 1/23 [>.............................] - ETA: 0s - loss: 0.7084 - accuracy: 0.8750
11/23 [=============>................] - ETA: 0s - loss: 0.6386 - accuracy: 0.9062
21/23 [==========================>...] - ETA: 0s - loss: 0.6861 - accuracy: 0.8750
23/23 [==============================] - 0s 8ms/step - loss: 0.6916 - accuracy: 0.8722 - val_loss: 2.4100 - val_accuracy: 0.4000 - lr: 2.0000e-04
模型已保存至 D:\Users\admin\Documents\MATLAB\moshishibie_lib\第四次作业-高光谱降维与分类\outputs\run_20241215_155605\best_model.h5
Function 'perform_deep_learning_classification' executed in 18.3286 seconds.
每一类的分类正确率为：
第 1 类正确率为： 32.58%
第 2 类正确率为： 15.14%
第 3 类正确率为： 66.58%
第 4 类正确率为： 92.31%
第 5 类正确率为： 98.96%
第 6 类正确率为： 94.42%
第 7 类正确率为： 87.48%
第 8 类正确率为： 48.46%
第 9 类正确率为： 99.65%
总体分类正确率为: 44.29%

=== 分类方法比较 ===

分类方法：优化KNN
总体分类正确率（OA）: 76.40%
第 1 类正确率： 74.18%
第 2 类正确率： 73.38%
第 3 类正确率： 70.34%
第 4 类正确率： 93.18%
第 5 类正确率： 99.28%
第 6 类正确率： 72.53%
第 7 类正确率： 90.08%
第 8 类正确率： 72.61%
第 9 类正确率： 100.00%

分类方法：随机森林
总体分类正确率（OA）: 84.03%
第 1 类正确率： 78.52%
第 2 类正确率： 84.96%
第 3 类正确率： 75.24%
第 4 类正确率： 95.61%
第 5 类正确率： 99.52%
第 6 类正确率： 79.75%
第 7 类正确率： 91.95%
第 8 类正确率： 78.62%
第 9 类正确率： 99.88%

分类方法：SVM
总体分类正确率（OA）: 60.27%
第 1 类正确率： 65.17%
第 2 类正确率： 53.45%
第 3 类正确率： 47.27%
第 4 类正确率： 97.84%
第 5 类正确率： 99.52%
第 6 类正确率： 50.74%
第 7 类正确率： 91.38%
第 8 类正确率： 42.18%
第 9 类正确率： 100.00%

分类方法：深度学习
总体分类正确率（OA）: 44.29%
第 1 类正确率： 32.58%
第 2 类正确率： 15.14%
第 3 类正确率： 66.58%
第 4 类正确率： 92.31%
第 5 类正确率： 98.96%
第 6 类正确率： 94.42%
第 7 类正确率： 87.48%
第 8 类正确率： 48.46%
第 9 类正确率： 99.65%

=== 简要分析 ===
最佳分类方法是：随机森林，总体分类正确率为 84.03%
验证集正确结果已保存至 D:\Users\admin\Documents\MATLAB\moshishibie_lib\第四次作业-高光谱降维与分类\outputs\run_20241215_155605\Validation_Truth.png
